> load "cuboids.magma";
Loading "cuboids.magma"
Setting up ground field L, projective space and the surface S...
Constructing the known curves on S...
Computing the intersection matrix...
Time: 12.940
Have checked that the group generated by the known curves has rank 64.

Setting up the action of Aut and Gal on Pic(S)...
#Aut(S) = 1536

Have verified that Pic(S) is generated by known curves
IF the hyperplane section is not divisible by 2.

Have verified that the algebraic Brauer group of S over Q equals Br_0.

============================================================================

Now setting up K3 quotient...
Constructing known curves on K...
Setting up intersection matrix for K...
Set up the Picard group of K...

Constructing canonical maps Pic(S) --> Pic(K) and Pic(K) --> Pic(S)...

=========================================================================

Now setting up intermediate surface K~ = S/<sigma_c>...
... and the maps between Pic(S), Pic(K~) and Pic(K)...

Setting up the action of Aut and Gal on Pic(K)...
#Aut(K) = 192

Have verified that Pic(K) is generated by known curves.
In particular, there are no curves of odd degree on K.

=========================================================================

=========================================================================

> // We write down (orbit representatives) of the various fibrations
> F<t> := FunctionField(L);
> Q3rep := a1^2 + b1^2 - c^2;
> // Param: (a1, b1, c) = (t^2 - 1, 2*t, t^2 + 1)
> St<A1,A2,A3,B1,B2,B3,C> := BaseChange(S, F);
> fib1 := Curve(St, Minors(Matrix([[A1,B1,C], [t^2-1, 2*t, t^2+1]]), 2));
> MinimalBasis(fib1);
[
    B1 - 2*t/(t^2 + 1)*C,
    A1 + (-t^2 + 1)/(t^2 + 1)*C,
    B2^2 + B3^2 + (-2*t^4 - 2)/(t^4 + 2*t^2 + 1)*C^2,
    A3^2 + B3^2 - C^2,
    A2^2 - B3^2 + (t^4 - 2*t^2 + 1)/(t^4 + 2*t^2 + 1)*C^2
]
> 
> // a1^2 + a2^2 + a3^2 - c^2, t = (c + a1)/(a2 + i a3) = (a2 - i a3)/(c - a1) 
> fib2 := Curve(St, [t*(A2 + i*A3) - (C + A1), t*(C - A1) - (A2 - i*A3)]);
> MinimalBasis(fib2);
[
    A2 + (i*t^2 - i)/(t^2 + 1)*A3 - 2*t/(t^2 + 1)*C,
    A1 - 2*i*t/(t^2 + 1)*A3 + (-t^2 + 1)/(t^2 + 1)*C,
    B2^2 + (t^4 - 2*t^2 + 1)/(t^4 + 2*t^2 + 1)*B3^2 + (-4*i*t^3 + 4*i*t)/(t^4 + 
        2*t^2 + 1)*A3*C + (-2*t^4 + 4*t^2 - 2)/(t^4 + 2*t^2 + 1)*C^2,
    B1^2 + 4*t^2/(t^4 + 2*t^2 + 1)*B3^2 + (4*i*t^3 - 4*i*t)/(t^4 + 2*t^2 + 
        1)*A3*C - 8*t^2/(t^4 + 2*t^2 + 1)*C^2,
    A3^2 + B3^2 - C^2
]
> 
> [e*LCM([Denominator(z) : z in Coefficients(e)]) : e in $1];
[
    (t^2 + 1)*A2 + (i*t^2 - i)*A3 - 2*t*C,
    (t^2 + 1)*A1 - 2*i*t*A3 + (-t^2 + 1)*C,
    (t^4 + 2*t^2 + 1)*B2^2 + (t^4 - 2*t^2 + 1)*B3^2 + (-4*i*t^3 + 4*i*t)*A3*C + 
        (-2*t^4 + 4*t^2 - 2)*C^2,
    (t^4 + 2*t^2 + 1)*B1^2 + 4*t^2*B3^2 + (4*i*t^3 - 4*i*t)*A3*C - 8*t^2*C^2,
    A3^2 + B3^2 - C^2
]
> 
> 
> Scheme(St, A1^2 - A2^2 + B1^2 - B2^2) eq St;
true
> fib3 := Curve(St, [t*(B2 + B1) - (A1 + A2), t*(A1 - A2) - (B2 - B1)]);
> [e*LCM([Denominator(z) : z in Coefficients(e)]) : e in MinimalBasis(fib3)];
[
    t*A2 + (-1/2*t^2 - 1/2)*B1 + (-1/2*t^2 + 1/2)*B2,
    t*A1 + (-1/2*t^2 + 1/2)*B1 + (-1/2*t^2 - 1/2)*B2,
    (t^4 - 1)*B1*B2 + (-1/2*t^4 - t^2 - 1/2)*B3^2 + (t^4 + 1)*C^2,
    B1^2 + B2^2 + B3^2 - 2*C^2,
    A3^2 + B3^2 - C^2
]
> fib4 := Curve(St, [t*(s*C + B3) - (B1 + i*B2), t*(B1 - i*B2) - (s*C - B3)]); 
> [e*LCM([Denominator(z) : z in Coefficients(e)]) : e in MinimalBasis(fib4)];
[
    t*B2 + (1/2*i*t^2 + 1/2*i)*B3 + (1/2*s*i*t^2 - 1/2*s*i)*C,
    t*B1 + (-1/2*t^2 + 1/2)*B3 + (-1/2*s*t^2 - 1/2*s)*C,
    A3^2 + B3^2 - C^2,
    t^2*A2^2 + (-1/4*t^4 - 1/2*t^2 - 1/4)*B3^2 + (-1/2*s*t^4 + 1/2*s)*B3*C + 
        (-1/2*t^4 - 1/2)*C^2,
    t^2*A1^2 + (1/4*t^4 - 1/2*t^2 + 1/4)*B3^2 + (1/2*s*t^4 - 1/2*s)*B3*C + 
        (1/2*t^4 + 1/2)*C^2
]
> [a[j]*$1[j] : j in [1..5]] where a := [2,2,1,4,4];
[
    2*t*B2 + (i*t^2 + i)*B3 + (s*i*t^2 - s*i)*C,
    2*t*B1 + (-t^2 + 1)*B3 + (-s*t^2 - s)*C,
    A3^2 + B3^2 - C^2,
    4*t^2*A2^2 + (-t^4 - 2*t^2 - 1)*B3^2 + (-2*s*t^4 + 2*s)*B3*C + (-2*t^4 - 
        2)*C^2,
    4*t^2*A1^2 + (t^4 - 2*t^2 + 1)*B3^2 + (2*s*t^4 - 2*s)*B3*C + (2*t^4 + 2)*C^2
]
> Pr2<U,W,V> := ProjectiveSpace(F, [1,3,1]);
> Curve(Image(map<fib3 -> Pr2 | [B1, A3*B3*C, B2]>));
Curve over Univariate rational function field over L defined by
U^6 + (6*t^8 + 4*t^4 + 6)/(t^8 - 1)*U^5*V + 15*U^4*V^2 + (20*t^8 - 8*t^4 + 
    20)/(t^8 - 1)*U^3*V^3 + 15*U^2*V^4 + (6*t^8 + 4*t^4 + 6)/(t^8 - 1)*U*V^5 + 
    V^6 + 32*t^6/(t^12 - t^8 - t^4 + 1)*W^2
> -1/(2*t^6/(t^12 - t^8 - t^4 + 1))*DefiningEquation($1);
(-1/2*t^12 + 1/2*t^8 + 1/2*t^4 - 1/2)/t^6*U^6 + (-3*t^12 + t^8 - t^4 + 
    3)/t^6*U^5*V + (-15/2*t^12 + 15/2*t^8 + 15/2*t^4 - 15/2)/t^6*U^4*V^2 + 
    (-10*t^12 + 14*t^8 - 14*t^4 + 10)/t^6*U^3*V^3 + (-15/2*t^12 + 15/2*t^8 + 
    15/2*t^4 - 15/2)/t^6*U^2*V^4 + (-3*t^12 + t^8 - t^4 + 3)/t^6*U*V^5 + 
    (-1/2*t^12 + 1/2*t^8 + 1/2*t^4 - 1/2)/t^6*V^6 - 16*W^2
> 1/16*$1;
(-1/32*t^12 + 1/32*t^8 + 1/32*t^4 - 1/32)/t^6*U^6 + (-3/16*t^12 + 1/16*t^8 - 
    1/16*t^4 + 3/16)/t^6*U^5*V + (-15/32*t^12 + 15/32*t^8 + 15/32*t^4 - 
    15/32)/t^6*U^4*V^2 + (-5/8*t^12 + 7/8*t^8 - 7/8*t^4 + 5/8)/t^6*U^3*V^3 + 
    (-15/32*t^12 + 15/32*t^8 + 15/32*t^4 - 15/32)/t^6*U^2*V^4 + (-3/16*t^12 + 
    1/16*t^8 - 1/16*t^4 + 3/16)/t^6*U*V^5 + (-1/32*t^12 + 1/32*t^8 + 1/32*t^4 - 
    1/32)/t^6*V^6 - W^2
> Parent($1);
Graded Polynomial ring of rank 3 over Univariate rational function field over L
Order: Graded Reverse Lexicographical
Variables: U, W, V
Variable weights: [1, 3, 1]
> Evaluate($2, [U,0,V]);
(-1/32*t^12 + 1/32*t^8 + 1/32*t^4 - 1/32)/t^6*U^6 + (-3/16*t^12 + 1/16*t^8 - 
    1/16*t^4 + 3/16)/t^6*U^5*V + (-15/32*t^12 + 15/32*t^8 + 15/32*t^4 - 
    15/32)/t^6*U^4*V^2 + (-5/8*t^12 + 7/8*t^8 - 7/8*t^4 + 5/8)/t^6*U^3*V^3 + 
    (-15/32*t^12 + 15/32*t^8 + 15/32*t^4 - 15/32)/t^6*U^2*V^4 + (-3/16*t^12 + 
    1/16*t^8 - 1/16*t^4 + 3/16)/t^6*U*V^5 + (-1/32*t^12 + 1/32*t^8 + 1/32*t^4 - 
    1/32)/t^6*V^6
> Factorization($1);
[
    <U + (t + 1)/(t - 1)*V, 1>,
    <U + (t - 1)/(t + 1)*V, 1>,
    <U + (t + i)/(t - i)*V, 1>,
    <U + (t - i)/(t + i)*V, 1>,
    <U + (t^2 + i)/(t^2 - i)*V, 1>,
    <U + (t^2 - i)/(t^2 + i)*V, 1>
]
> FQ<t> := FunctionField(Rationals());
> PFQ<X> := PolynomialRing(FQ);
> Evaluate($2, [X,0,1]);
(-1/32*t^12 + 1/32*t^8 + 1/32*t^4 - 1/32)/t^6*X^6 + (-3/16*t^12 + 1/16*t^8 - 
    1/16*t^4 + 3/16)/t^6*X^5 + (-15/32*t^12 + 15/32*t^8 + 15/32*t^4 - 
    15/32)/t^6*X^4 + (-5/8*t^12 + 7/8*t^8 - 7/8*t^4 + 5/8)/t^6*X^3 + 
    (-15/32*t^12 + 15/32*t^8 + 15/32*t^4 - 15/32)/t^6*X^2 + (-3/16*t^12 + 
    1/16*t^8 - 1/16*t^4 + 3/16)/t^6*X + (-1/32*t^12 + 1/32*t^8 + 1/32*t^4 - 
    1/32)/t^6
> Parent($1);
Univariate Polynomial Ring in X over Univariate rational function field over 
Rational Field
> $2*t^6;
(-1/32*t^12 + 1/32*t^8 + 1/32*t^4 - 1/32)*X^6 + (-3/16*t^12 + 1/16*t^8 - 
    1/16*t^4 + 3/16)*X^5 + (-15/32*t^12 + 15/32*t^8 + 15/32*t^4 - 15/32)*X^4 + 
    (-5/8*t^12 + 7/8*t^8 - 7/8*t^4 + 5/8)*X^3 + (-15/32*t^12 + 15/32*t^8 + 
    15/32*t^4 - 15/32)*X^2 + (-3/16*t^12 + 1/16*t^8 - 1/16*t^4 + 3/16)*X - 
    1/32*t^12 + 1/32*t^8 + 1/32*t^4 - 1/32
> $1*64;
(-2*t^12 + 2*t^8 + 2*t^4 - 2)*X^6 + (-12*t^12 + 4*t^8 - 4*t^4 + 12)*X^5 + 
    (-30*t^12 + 30*t^8 + 30*t^4 - 30)*X^4 + (-40*t^12 + 56*t^8 - 56*t^4 + 
    40)*X^3 + (-30*t^12 + 30*t^8 + 30*t^4 - 30)*X^2 + (-12*t^12 + 4*t^8 - 4*t^4 
    + 12)*X - 2*t^12 + 2*t^8 + 2*t^4 - 2
> pol := $1;
> GCD([Numerator(c) : c in Coefficients(pol)]);
$.1^4 - 1
> 1/$1*pol;
(-2*t^8 + 2)*X^6 + (-12*t^8 - 8*t^4 - 12)*X^5 + (-30*t^8 + 30)*X^4 + (-40*t^8 + 
    16*t^4 - 40)*X^3 + (-30*t^8 + 30)*X^2 + (-12*t^8 - 8*t^4 - 12)*X - 2*t^8 + 2
> Factorization($1);
[
    <X + (t + 1)/(t - 1), 1>,
    <X + (t - 1)/(t + 1), 1>,
    <X^2 + (2*t^2 - 2)/(t^2 + 1)*X + 1, 1>,
    <X^2 + (2*t^4 - 2)/(t^4 + 1)*X + 1, 1>
]
> -$2;
(2*t^8 - 2)*X^6 + (12*t^8 + 8*t^4 + 12)*X^5 + (30*t^8 - 30)*X^4 + (40*t^8 - 
    16*t^4 + 40)*X^3 + (30*t^8 - 30)*X^2 + (12*t^8 + 8*t^4 + 12)*X + 2*t^8 - 2

Total time: 25.769 seconds, Total memory usage: 310.62MB
